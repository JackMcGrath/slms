{% macro comments(comments, authorId, commentsForm) %}
    {% import _self as self %}
    <div class="comments">
        {% for comment in comments %}
            {{ self.comment_text_block(comment, authorId) }}
            {% if commentsForm is defined %}
                {{ self.comment_form(commentsForm) }}
            {% endif %}
        {% endfor %}
    </div>
{% endmacro %}

{% macro comment_text_block(comment, authorId) %}
    <div class="comment">
        <div class="avatar"><img class="rounded" src="{{ get_file_storage_link(comment.user.getAvatarFile()) | imagine_filter('thumbnail') }}" /> </div>
        <div class="content">
            <div class="author">{{ comment.user.fullName }} <span class="gray">{{ time_diff(comment.createdAt) }}</span></div>
            <div class="text {% if comment.user.id == authorId %}by_author{% endif %}">{{ comment.feedContent.text }}</div>
            <div class="link"><a href="{{ comment.feedContent.linkUrl }}">{{ comment.feedContent.linkUrl }}</a></div>
        </div>
    </div>
{% endmacro %}

{% macro comment_form(commentForm) %}

{% endmacro %}

{% macro item_form(form, formPath) %}
    <div class="form">
        <form id="ajaxFeedCommentForm" method="post" {{ form_enctype(form) }} action="{{ formPath }}">
            <textarea id="comment_input" name="feed_comment[feedContent][text]" placeholder="Share what's new..." ></textarea>
            <div class="controls">
                <div class="attached-link">
                    <input id="attached-link-field" type="text" name="feed_comment[feedContent][link_url]" placeholder="Enter link..." />
                    <input id="comment-type" type="hidden" name="feed_comment[feedContent][type]" value="text" />
                    <div class="attached-link-delete" style="">
                        <i class="icon-small-trash-bin"></i> <a class="gray" href="#">Delete</a>
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="buttons">
                    <input type="submit" class="btn post-button" value="Post message" />
                    <div class="attach-links">
                        <a class="attach-link" data-link-type="image" href="#"><img src="/img/feed_image_icon.png" alt="Add Image" /></a>
                        <a class="attach-link" data-link-type="video" href="#"><img src="/img/feed_video_icon.png" alt="Add Video" /></a>
                        <a class="attach-link" data-link-type="website" href="#"><img src="/img/feed_website_icon.png" alt="Add Link" /></a>
                    </div>
                </div>
            </div>
            {{ form_widget(form._token) }}
        </form>
    </div>
{% endmacro %}

{% macro feed(itemForm, itemFormPath, comments, authorId, commentForm, commentFormPath) %}
    {% import _self as self %}
    <div class="feed">
    {{ self.item_form(itemForm, itemFormPath) }}
    {{ self.comments(comments, authorId) }}
    </div>

{% endmacro %}
