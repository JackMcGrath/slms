{% extends 'ZerebralFrontendBundle::layout.html.twig' %}

{% block content %}
    <div class="row-fluid course-members">
        <div class="top-second-navbar">
            <ul>
                <li><a href="#">Feed</a></li>
                <li><a href="{{ path('course_assignments', {id: course.id}) }}">Assignments</a></li>
                <li><a href="{{ path('course_view', {id: course.id}) }}">Details</a></li>
                <li><a href="#">Materials</a></li>
                <li class="active"><a href="{{ path('course_members', {id: course.id}) }}">Members</a></li>
            </ul>
        </div>
        <div class="row-fluid">
            <h2 class="span6 pull-left form-title">{{ course.name }} <small>course members</small></h2>
            <div class="pull-right filter">
                <span>Show:</span> <a href="#">All</a> | <a href="">Students</a>
            </div>
            <div class="clearfix"></div>
            <hr/>

            <div class="members-list">
                {% for member in students %}
                    {{ block('member') }}
                {% endfor %}
                {% for member in teachers %}
                    {{ block('member') }}
                {% endfor %}

                {% if is_granted('ROLE_TEACHER') %}
                <div class="form-actions">
                    <a href="#inviteModal" class="btn btn-danger invite" data-toggle="modal" data-target="#inviteModal">Invite someone by email</a>
                    or share an access code: <b>JWBGN-9KX1X5</b>
                    <a href="#" class="reset">reset</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="modal hide fade" id="inviteModal">
        <form method="post" {{ form_enctype(form) }} novalidate>
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3>Invite users</h3>
            </div>
            <div class="modal-body">
                <p>
                    To send invitations to join your course, enter one ore more email addresses into the text box, separated by space or new lines, and click "Send Invites" button.
                </p>
                {{ form_row(form.emailList, {
                    label: '',
                    form_type: 'horizontal',
                    attr: {
                        class: 'input-block-level',
                        rows: 6
                    }
                }) }}
                <div class="clearfix"></div>
                <p>
                    Your course currently has {{ students|length + teachers|length }} of 50 available. Invite(s) remaining: {{ 50 - students|length - teachers|length }} for your current plan.
                </p>

                <input type="submit" class="btn btn-danger" value="Send Invites"/>
                <a href="#" class="btn" data-dismiss="modal" aria-hidden="true">Cancel</a>
            </div>
            {{ form_rest(form) }}
        </form>
    </div>

{% endblock %}

{% block member %}
    <div class="member">
        <div class="avatar"><img src="http://www.gravatar.com/avatar/205e460b479e2e5b48aec07710c08d50?s=50"/></div>
        <div class="info">
            <a href="#">{{ member.fullName }}</a>
            <span>{{ member.user.role | capitalize }}</span>
        </div>
        <div class="mail rounded">
            <a href="#">
                <i class="icon-gray-mail"></i>
            </a>
        </div>
    </div>
{% endblock %}